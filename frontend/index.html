<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asia Restaurant - Sensor Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7/css/materialdesignicons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
</head>
<body>

<header>
    <div class="header-content">
        <div class="header-title">
            <span class="mdi mdi-silverware-fork-knife"></span>
            <h1>Asia Restaurant</h1>
            <span class="header-subtitle">Dashboard</span>
        </div>
    </div>
</header>

<nav>
    <button class="nav-btn active" data-tab="dashboard"><span class="mdi mdi-view-dashboard"></span> Dashboard</button>
    <button class="nav-btn" data-tab="regression"><span class="mdi mdi-chart-scatter-plot-hexbin"></span> Regression</button>
    <button class="nav-btn" data-tab="sensors"><span class="mdi mdi-thermometer"></span> Sensoren</button>
    <button class="nav-btn" data-tab="history"><span class="mdi mdi-table-clock"></span> Verlauf</button>
</nav>

<div id="errorBanner" class="error-banner" style="display:none;">
    <span class="mdi mdi-alert-circle"></span>
    <span id="errorMessage">Verbindung zum Server fehlgeschlagen</span>
</div>

<main>
    <section id="tab-dashboard" class="tab-content active">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-thermometer"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="currentTemp">--</span>
                    <span class="stat-label">Temperatur</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-water-percent"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="currentHumidity">--</span>
                    <span class="stat-label">Luftfeuchtigkeit</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-molecule-co2"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="currentVOC">--</span>
                    <span class="stat-label">VOC (Gasresistenz)</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-account-group"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="currentOccupancy">--</span>
                    <span class="stat-label">Gesch. Personen</span>
                    <span class="stat-detail" id="currentOccPercent">--</span>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header"><h3><span class="mdi mdi-chart-line"></span> Temperaturverlauf (24h)</h3></div>
            <div class="card-body chart-container"><canvas id="chartTemperature"></canvas></div>
        </div>
        <div class="charts-grid">
            <div class="card">
                <div class="card-header"><h3><span class="mdi mdi-chart-line"></span> Luftfeuchtigkeit (24h)</h3></div>
                <div class="card-body chart-container"><canvas id="chartHumidity"></canvas></div>
            </div>
            <div class="card">
                <div class="card-header"><h3><span class="mdi mdi-chart-line"></span> Personenanzahl (24h)</h3></div>
                <div class="card-body chart-container"><canvas id="chartOccupancy"></canvas></div>
            </div>
        </div>
    </section>

    <section id="tab-regression" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-chart-timeline-variant"></span></div>
                <div class="stat-info">
                    <span class="stat-label">Steigung (a) [°C/h]</span>
                    <span class="stat-value" id="regSlope">--</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-ray-start-end"></span></div>
                <div class="stat-info">
                    <span class="stat-label">Achsenabschnitt (b)</span>
                    <span class="stat-value" id="regIntercept">--</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-check-decagram"></span></div>
                <div class="stat-info">
                    <span class="stat-label">R² (Bestimmtheitsmass)</span>
                    <span class="stat-value" id="regR2">--</span>
                    <span class="stat-detail" id="regR2Detail">--</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-database"></span></div>
                <div class="stat-info">
                    <span class="stat-label">Datenpunkte</span>
                    <span class="stat-value" id="regSamples">--</span>
                    <span class="stat-detail" id="regTrainedAt">--</span>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header">
                <h3><span class="mdi mdi-chart-scatter-plot-hexbin"></span> Temperaturverlauf ueber Zeit</h3>
                <span class="stat-detail" id="regFormula">T = a · h + b</span>
            </div>
            <div class="card-body chart-container-large"><canvas id="chartScatter"></canvas></div>
        </div>
        <div class="card">
            <div class="card-header"><h3><span class="mdi mdi-cog"></span> Modell-Verwaltung</h3></div>
            <div class="card-body">
                <button class="btn-primary" id="btnRetrain"><span class="mdi mdi-refresh"></span> Modell neu trainieren (alle Daten)</button>
                <span class="stat-detail" id="retrainStatus"></span>
            </div>
        </div>
    </section>

    <section id="tab-sensors" class="tab-content">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-thermometer"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="sensorTemp">--</span>
                    <span class="stat-label">Temperatur</span>
                    <span class="stat-detail" id="sensorTempRange">--</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-water-percent"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="sensorHumidity">--</span>
                    <span class="stat-label">Luftfeuchtigkeit</span>
                    <span class="stat-detail" id="sensorHumidityAvg">--</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-molecule-co2"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="sensorGas">--</span>
                    <span class="stat-label">VOC / Gasresistenz</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><span class="mdi mdi-radar"></span></div>
                <div class="stat-info">
                    <span class="stat-value" id="sensorMovement">--</span>
                    <span class="stat-label">Bewegung (RCWL-0516)</span>
                    <span class="stat-detail" id="sensorMovementStatus">--</span>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header"><h3><span class="mdi mdi-molecule-co2"></span> VOC / Gasresistenz (24h)</h3></div>
            <div class="card-body chart-container"><canvas id="chartGas"></canvas></div>
        </div>
        <div class="card">
            <div class="card-header"><h3><span class="mdi mdi-gauge"></span> Luftdruck (24h)</h3></div>
            <div class="card-body chart-container"><canvas id="chartPressure"></canvas></div>
        </div>
    </section>

    <section id="tab-history" class="tab-content">
        <div class="card">
            <div class="card-header">
                <h3><span class="mdi mdi-table"></span> Sensordaten</h3>
                <div class="table-info" id="tableInfo">--</div>
            </div>
            <div class="card-body table-wrapper">
                <table id="dataTable">
                    <thead>
                        <tr><th>ID</th><th>Zeitstempel</th><th>Temp (°C)</th><th>Feucht. (%)</th><th>VOC (Ohm)</th><th>Bewegung</th><th>Gesch. Personen</th></tr>
                    </thead>
                    <tbody id="tableBody"><tr><td colspan="7">Lade Daten...</td></tr></tbody>
                </table>
            </div>
            <div class="pagination">
                <button class="btn-sm" id="btnPrev"><span class="mdi mdi-chevron-left"></span> Zurueck</button>
                <span id="pageInfo">Seite 1</span>
                <button class="btn-sm" id="btnNext">Weiter <span class="mdi mdi-chevron-right"></span></button>
            </div>
        </div>
    </section>
</main>

<footer>
    <p>Asia Restaurant &mdash; Letzte Aktualisierung: <span id="lastUpdate"></span></p>
</footer>

<script src="/static/js/dashboard.js?v=4"></script>
</body>
</html>